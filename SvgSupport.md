

This idea came up on the [piccolo2d-dev maillist](http://groups.google.com/group/piccolo2d-dev/browse_thread/thread/df17f5cb0edfefe8).

TODO: insert the [options Michael mentioned](http://groups.google.com/group/piccolo2d-dev/browse_thread/thread/eab6481afdb09d3b) and the example from the comment below.

See also issue#61 (on Google Code) issue#81 (on Google Code)

And have a look at http://wiki.svg.org/JSR_226 and http://wiki.svg.org/JSR_287

# Motivation
Piccolo2d is a scenegraph ZUI toolkit, [svg](http://en.wikipedia.org/wiki/Scalable_Vector_Graphics) is a 2d vector graphics description language. Both share the idea of a scene graph and the grouping and transformation concepts also look similar at a first glance.

Is it possible to use svg documents e.g. generated by [inkscape](http://www.inkscape.org/) as input and convert them to piccolo2d scenegraphs?

# History

There was some idea to build svg support into [jazz](http://www.piccolo2d.org/download.html). The [v1.1 API](http://www.piccolo2d.org/doc/jazz/release-1.1/apidocs/index.html) has some svg classes.

# Requirements

  * parse svg xml (e.g. using the super-lightweight [XPP3 min](http://repo1.maven.org/maven2/xpp3/xpp3/1.1.3.3_min/) xml pull parser).
  * parse css and build up a hierarchy.
  * parse svg paths and convert to generalpaths (shapes)
  * look up nodes in a piccolo2d scenegraph according to their ID (tree search)

# Concepts

  * keep it as lean as possible (<100K ?)
  * do NOT add any new runtime/build requirements
  * use a factory/strategy to parse the svg input
  * add a css manager class
  * create a scenegraph ([PNode](http://www.piccolo2d.org/doc/piccolo2d.java/release-1.2.1/apidocs/edu/umd/cs/piccolo/PNode.html)) using out-of-the-box [PNode](http://www.piccolo2d.org/doc/piccolo2d.java/release-1.2.1/apidocs/edu/umd/cs/piccolo/PNode.html), [PPath](http://www.piccolo2d.org/doc/piccolo2d.java/release-1.2.1/apidocs/edu/umd/cs/piccolo/PPath.html), [PText](http://www.piccolo2d.org/doc/piccolo2d.java/release-1.2.1/apidocs/edu/umd/cs/piccolo/PText.html), [PImage](http://www.piccolo2d.org/doc/piccolo2d.java/release-1.2.1/apidocs/edu/umd/cs/piccolo/PImage.html) classes
  * attach node id, css classes etc. as attributes.

# Steps
Aim for for [SVG 1.1 Tiny](http://www.w3.org/TR/SVGMobile/#sec-overview) and use the examples from the specification as test input. Development happens in the [svg2009 branch](http://piccolo2d.googlecode.com/svn/piccolo2d.java/branches/svg2009).

As I develop this in a local git repo and merge to svn, a finer-grained commit history can be obtained from the [git://github.com/mro/piccolo2d.java.git](http://github.com/mro/piccolo2d.java/) repository.

  1. Proof a concept
    1. Sax Parser to read the svg xml
    1. The following [Basic Shapes](http://www.w3.org/TR/SVG11/shapes.html) with styling via attributes (no CSS, no "style" attribute)
      1. [&lt;rect /&gt;](http://www.w3.org/TR/SVG11/shapes.html#RectElement)
      1. [&lt;circle /&gt;](http://www.w3.org/TR/SVG11/shapes.html#CircleElement)
  1. CSS, step I:
    1. ["style" attribute](http://www.w3.org/TR/SVG11/styling.html#StyleAttribute)
  1. Complete the basic shape module
    1. [&lt;ellipse /&gt;](http://www.w3.org/TR/SVG11/shapes.html#EllipseElement)
    1. [&lt;line /&gt;](http://www.w3.org/TR/SVG11/shapes.html#LineElement)
    1. [&lt;polyline /&gt;](http://www.w3.org/TR/SVG11/shapes.html#PolylineElement)
    1. [&lt;polygon /&gt;](http://www.w3.org/TR/SVG11/shapes.html#PolygonElement)
    1. [&lt;path /&gt;](http://www.w3.org/TR/SVG11/paths.html#PathElement) without [elliptical arcs](http://www.w3.org/TR/SVG11/paths.html#PathDataEllipticalArcCommands)
  1. CSS, step II:
    1. ["style" element](http://www.w3.org/TR/SVG11/styling.html#StyleElement)
  1. [&lt;use /&gt;](http://www.w3.org/TR/SVG11/struct.html#UseElement) Element
  1. [Basic Text](http://www.w3.org/TR/SVG11/text.html#basic-text-mod)
  1. [Images](http://www.w3.org/TR/SVG11/struct.html#ImageElement)
  1. evtl. [Basic Font](http://www.w3.org/TR/SVG11/fonts.html#basic-font-mod)

# Obstacles

  * css parsing: more than rudimentary support is a terrible lot of code. See http://www.w3.org/Style/CSS/SAC/, http://cssparser.sourceforge.net/ and http://today.java.net/pub/a/today/2003/10/14/swingcss.html
  * the "path" element arcs require complex code. See [Batik ExtendedGeneralPath](http://xmlgraphics.apache.org/batik/javadoc/org/apache/batik/ext/awt/geom/ExtendedGeneralPath.html)
  * the "use" element requires cloning and re-application of the CSS on every node. The PNode.clone() implementation is rather slow.
  * the "text" element will be only rudimentary (no text along a path, rotated glyphs etc.)
  * graceful failure for unexpected svg features?
  * fatal failure for invalid svg (validating parser?)

# Links
  * http://www.elementengine.com/